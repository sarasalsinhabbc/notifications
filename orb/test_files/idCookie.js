define("idcta/idCookie",["id-config"],function(b){var a={};var e=86400000;var d;function f(){if(!d){d=new c()}else{d.refreshCookie()}return d}function c(){var p=this;this.valid=false;this.id="";this.username="~";this.displayname="";this.timestamp="";this.cookieAgeDays=(typeof b.identity!="undefined"&&b.identity.cookieAgeDays)?b.identity.cookieAgeDays:730;k();this.refreshCookie=function(){h()};this.hasCookie=function(){if(n(p.timestamp)){o()}return p.valid};this.getIdFromCookie=function(){if(n(p.timestamp)){o()}return p.id?p.id:null};this.getNameFromCookie=function(){if(n(p.timestamp)){o()}if(p.displayname!==""){return p.displayname.replace(/\+/g," ")}if(p.username&&!(p.username.charAt(0)==="~")){return p.username}return null};function k(){m();h()}function m(){if(typeof window.bbccookies==="object"){var q=document.cookie.match(/ckpf_APHID=([^;]*)/);if(q){if(!window.bbccookies.isAllowed("ckpf_APHID")){g()}}}}function h(){var r=document.cookie.match(/IDENTITY=([^;]*)/);if(r){var q=decodeURIComponent(r[1]).split("|");if(j(q)&&!n(q[3])){p.valid=true;p.id=q[0];p.username=q[1];p.displayname=decodeURIComponent(q[2]);p.timestamp=q[3]}else{o()}}else{i()}}function j(q){return(6<=q.length)}function n(r){var s=p.cookieAgeDays*e,q=new Date().getTime();return(q-r>=s)}function o(){i();l()}function i(){p.valid=false;p.id="";p.username="~";p.displayname="";p.timestamp=""}function l(){document.cookie="IDENTITY=; Expires=Thu, 01 Jan 1970 00:00:00 GMT; Domain=.bbc.co.uk; Path=/";document.cookie="IDENTITY_ENV=; Expires=Thu, 01 Jan 1970 01:00:00 GMT; Domain=.bbc.co.uk; Path=/";g()}function g(){document.cookie="ckpf_APHID=; Expires=Thu, 01 Jan 1970 01:00:00 GMT; Domain=.bbc.co.uk; Path=/"}}a.getInstance=f;return a});