define("istats-1",[],function(){var W={version:"2.0.0"},b=W,c=[],q={},g,h="",f=false,X="sa_labels",E="istats-notrack",ac="_istats_"+Math.random(),F={internal:true,external:true,download:true,clickthrough:true,promoimage:true},d={type:"",url:""},R=2000,K=10000,ab=500,x,e={ignore:/.+\.(jpe?g|gif|png)$/i,webUrl:/^(\.\.?\/|\/|https?:\/\/|[^\/.:]+([\/.]|$))/i,pseudoProtocol:/^(mailto:|javascript:|about:|view-source:|data:)/i,internalUrl:/^(?:\/\/|https?:\/\/)?(?:[^.]+\.)*((bbc|bbci)(?:\.co\.uk|\.com)|doubleclick\.net)(:|\/|$)/i,downloadUrl:/.+\.(pdf|te?xt|rtf|docx?|xlsx?|pptx?|od[tpsgbf]|mp[234]|m4a|mpeg|exe|dmg|zip|tgz)$/i,relativeUrl:/^(\.\.?\/|\/[^\/]|([^\/.:]+([\/.]|$)))/i,clickThrough:/^#sa-(.*?)(?:-sa(.*))?$/,hashLabels:/^ct_|ns_(fee|campaign|linkname|mchannel|source)=(.+?)$/,domain:/(bbc(?:\.co\.uk|\.com))$/i},H={},O={types:{"trackingfail.istats":true,"trackingsuccess.istats":true,"redirect.istats":true,"cookiecreated.istats":true}},j={},A=[],N=[],J=function(){var ae={};for(var af in O.types){ae[af]=[]}return ae},Y=M(X);v(window);Y=(Y||(r())._trackingCookie);y(X);function v(ae){(typeof ae.istats==="undefined")&&(ae.istats={});(typeof ae.istats.enabled==="undefined")&&(ae.istats.enabled=true);return ae}function r(ae){return ae?v(ae).istats:window.istats}W.getConfig=r;function D(){return f}W.isReady=D;function p(){if(typeof Y==="string"){d.type="internal";return ad(decodeURIComponent(Y))}}function P(ae){ae=ae.replace(/\+/g,"%20");return decodeURIComponent(ae)}function ad(ae){var ag={};var ai=ae.split("&");for(var af=0;af<ai.length;af++){var ah=ai[af].split("=");ag[ah[0]]=ah[1]}return ag}W._getLabelsFromString=ad;function u(ag){if(history.replaceState){var ae=location.protocol+"//"+location.host+(location.pathname?location.pathname:"");try{history.replaceState({},"",ae+ag)}catch(af){if(window.console&&console.log){console.log(af)}}}else{location.hash=ag}}function a(ae){ae||(ae=location.hash);if(ae!==""){var ai=ae.match(e.clickThrough),ag,ah="",aj=[];if(ai===null){return}if(ai[2]){ah="#"+ai[2]}u(ah);ag=ai[1];if(ag===""){return}d.type="click through";aj=ag.split("&");for(var af in aj){if(aj.hasOwnProperty(af)&&!e.hashLabels.test(aj[af])){aj[af]="ct_"+aj[af]}}return aj}}function I(){var af=true,ag=true,ae=(r()).enabled;if(window.bbcFlagpoles_istats){ag=!(window.bbcFlagpoles_istats==="ON")}if(ag||!ae){af=false}return af}W.isEnabled=I;W.setCountername=function(ae){g=ae};W.getCountername=function(){if(!g){g=Z()}if(!g.match(/\.page$/)){g+=".page"}return g};function Z(){var ae=window.location.pathname.replace(/\/$/,"").replace(/^\//,"").replace(/\//g,".");return ae+".page"}function T(ae){if(typeof(ae)!=="string"){throw (Error("'site' must be a string"))}ae=ae.toLowerCase().replace(/_/g,"-");return ae}W._normaliseLabelValue=T;W.setSite=function(ae){h=T(ae)};W.getSite=function(){if(!h){if(typeof(q.bbc_site)==="string"){b.setSite(q.bbc_site)}}return h};W.getDefaultURL=function(){try{var ae=b.getCollector("default")}catch(af){return""}return ae.url+"?"+V(n({}),"&")};function S(af,ae){if(!af.className){return false}return(" "+af.className+" ").indexOf(" "+ae+" ")===-1?false:true}function C(ag,af){var ae=(ag.className)?ag.className+" ":"";if(!S(ag,af)){ag.className=ae+af}}function s(ah,af){var ae=ah.className.split(" "),ai=[],ag=ae.length;while(ag--){if(ae[ag]!==af){ai.unshift(ae[ag])}}ah.className=(ai.length)?ai.join(" "):""}W.track=function(ae,ah){if(!I()){return}if(!F[ae]){throw ('Given linkType, "'+ae+'" is not valid.')}ah=ah||{};if(!ah.region){ah.region=[document.body]}if(typeof ah.region.push==="undefined"){ah.region=[ah.region]}var ag=ah.region.length;while(ag--){var ai=ah.region[ag];k(ai,ae);var af=ai[ac];af.linkTypesTracked[ae]=(ah||{});if(!af.trackerAttached){(function(aj){H.attach(aj,"click",function(ak){j.dispatch(aj,ak)})})(ai);af.trackerAttached=true}}};W.observe=function(ae,ag,ah){if(!O.types[ag]){throw ('Cannot observe: Given eventType, "'+ag+'" in unknown.')}if(typeof ae.push==="undefined"){ae=[ae]}var af=ae.length;while(af--){k(ae[af]);N[ae[af][ac].eventsKey][ag].push(ah)}};W._isInternal=function(ae){return W._isWebUrl(ae)&&(e.relativeUrl.test(ae)||e.internalUrl.test(ae))};W._isExternal=function(ae){return W._isWebUrl(ae)&&!b._isInternal(ae)};W._isDownload=function(ae){return e.webUrl.test(ae)&&e.downloadUrl.test(ae)};W._isWebUrl=function(ae){return e.webUrl.test(ae)&&!e.ignore.test(ae)&&!e.pseudoProtocol.test(ae)};W._getDomainFromHost=G;function G(ae){var af=ae.match(e.domain);return af?af[1]:ae}W._getLabelsFromHashString=a;W._createCookie=U;W._inspectTracking=function(ae){if(typeof ae!=="undefined"){d=ae}return d};W.log=function(af,ae,ag,ah){ag=ag||{};if(!I()){return}if(af.toLowerCase()!=="pageview"){ag.ns_type="hidden";ag.action_name=ae;ag.action_type=af}d.type="logging actions";z(ag,ah)};W.addNoTrack=function(ae){C(ae,E)};W.removeNoTrack=function(ae){s(ae,E)};function V(ah,ae){ae=ae||"&";var ag=[];if(ah.hasOwnProperty("name")){ag.push(encodeURIComponent("name")+"="+encodeURIComponent(ah.name))}for(var af in ah){if(ah.hasOwnProperty(af)&&typeof(ah[af])!="object"){if(af==="linkLocation"){ag.push(encodeURIComponent("link_location")+"="+encodeURIComponent(ah[af]))}else{if(af!=="name"&&af!=="ns_referrer"){ag.push(encodeURIComponent(af)+"="+encodeURIComponent(ah[af]))}}}}if(ah.hasOwnProperty("ns_referrer")){ag.push(encodeURIComponent("ns_referrer")+"="+encodeURIComponent(ah.ns_referrer))}return ag.join(ae)}W.addLabels=function(ae){if(typeof(ae)=="string"){ae=ad(P(ae))}o(q,ae)};W._getLabels=function(){return q};function o(ag,af){for(var ae in af){ag[ae]=af[ae]}return ag}O.notify=function(ai,ag,aj){var ae=N[ai[ac].eventsKey][ag];for(var af=0,ah=ae.length;af<ah;af++){if(typeof ae[af]==="function"){if(ae[af](aj)===false){return false}}}};H.attach=function(ae,ag,af){if(ae.addEventListener){ae.addEventListener(ag,af,false)}else{if(ae.attachEvent){ae.attachEvent("on"+ag,af)}else{ae["on"+ag]=af}}};H.detach=function(ae,ag,af){if(ae.removeEventListener){ae.removeEventListener(ag,af,false)}else{if(ae.detachEvent){ae.detachEvent("on"+ag,af)}else{ae["on"+ag]=null}}};H.getTarget=function(ae){ae=ae||window.event;return ae.target||ae.srcElement};function l(af,ae){var ag=af;do{if(ag.nodeName=="A"){return ag}if(ag===ae){return false}}while(ag=ag.parentNode)}function aa(ae){if(!b._isWebUrl(ae)){return}if(b._isExternal(ae)){return"external"}else{if(b._isDownload(ae)){return"download"}else{if(b._isInternal(ae)){return"internal"}}}}function t(ai,af,ah,ae,ag){ai.istats=ai.istats||{};ai.istats.linkType=af,ai.istats.linkTrackerUrl=ah,ai.istats.linkLocation=ae,ai.istats.linkElement=ag}j.dispatch=function(al,ak){var af=l(H.getTarget(ak),this),ae,ag,ai,ah,aj;if(!af||!af.href){return}ah=new Date().getTime();aj=(af.istatsTimestamp&&(ah-af.istatsTimestamp)<ab);if(aj||S(af,E)){return}ae=aa(af.href);ag=j[ae];ai=al[ac].linkTypesTracked[ae];if(!ae||!ag||!ai){return}af.istatsTimestamp=ah;ak.istats=ak.istats||{};j[ae](al,af,ak)};j.external=function(ah,af,ag){var ae=ah[ac].linkTypesTracked.external||{};ae.extlink_url=af.href;ae.ns_type="hidden";ae.action_type="extlink";ae.ns_referrer=B();if(af.id){ae.extlink_id=af.id}o(ae,L(af));if(!ae.linkLocation){ae.linkLocation=""}d.type="external";t(ag,"external",V(ae),ae.linkLocation,af);w(ae,ah,af,ag)};j.download=function(ah,af,ag){var ae=ah[ac].linkTypesTracked.download||{};ae.download_url=af.href;ae.ns_type="hidden";ae.action_type="download";ae.ns_referrer=B();if(af.id){ae.download_id=af.id}o(ae,L(af));if(!ae.linkLocation){ae.linkLocation=""}d.type="download";t(ag,"download",V(ae),ae.linkLocation,af);w(ae,ah,af,ag)};j.internal=function(ah,af,ag){var ae=ah[ac].linkTypesTracked.internal||{};ae.intlink_from_url=location.href;ae.intlink_ts=new Date().getTime();if(af.id){ae.intlink_id=af.id}o(ae,L(af));if(!ae.linkLocation){ae.linkLocation=""}Y=V(ae);U(X,Y,K);O.notify(ah,"cookiecreated.istats",ag)};function L(af){var ae={};while(af){if(af.linktrack){if(typeof(af.linktrack)==="string"){ae=ad(P(af.linktrack))}if(typeof(af.linktrack)==="object"){ae=af.linktrack}break}af=af.parentNode}return ae}function w(ak,aj,af,ag){var ae=ag.altKey||ag.ctrlKey||ag.metaKey||ag.shiftKey,ai=function(){};var ah=ae||(af.target&&!af.target.match(/^_(self|parent|top)$/i));if(!ah){ai=function(){if(O.notify(aj,"redirect.istats",ag)!==false){window.location.href=af.href}}}clearTimeout(x);x=setTimeout(function(){O.notify(aj,"trackingfail.istats",ag);ai()},R);z(ak,function(){clearTimeout(x);if(O.notify(aj,"trackingsuccess.istats",ag)!==false){ai()}},ag);if(!ah){if(ag.preventDefault){ag.preventDefault()}else{event.returnValue=false}}}function k(ae){if(typeof ae[ac]!=="undefined"){return}ae[ac]={eventsKey:N.length,linkTypesTracked:{}};N.push(J())}function U(ae,ak,ag){var ah=new Date(),aj=365*24*60*60*1000,am=window.location.host,ai,al,af;if(typeof ag==="undefined"){ag=aj}ah.setTime(ah.getTime()+ag);al="; expires="+ah.toGMTString();ai=G(am);af=ae+"="+ak+al+"; domain="+ai+"; path=/";document.cookie=af;return af}function M(ag){var aj=ag+"=",ai=document.cookie.split(";"),af;for(var ah=0,ae=ai.length;ah<ae;ah++){af=ai[ah];while(af.charAt(0)===" "){af=af.substring(1,af.length)}if(af.indexOf(aj)===0){return decodeURIComponent(af.substring(aj.length,af.length))}}return null}function y(ae){if(M(ae)!==null){U(ae,"",-1)}}W.addCollector=function(ae){if(typeof(ae)!=="object"){throw new Error("Only an object can be passed in as a collector")}if(!ae.name){throw new Error("Collector must have a name")}if(!ae.url){throw new Error("Collector must have a url")}c.push(ae);return true};W.getCollector=function(ae){for(var af=0;af<c.length;af++){if(c[af].name===ae){return c[af]}}throw Error("Unable to find "+ae+" in collectors")};function n(af){if(typeof(af)==="undefined"){af={}}for(var ae in q){if(typeof(af[ae])==="undefined"){af[ae]=q[ae]}}af.bbc_site=b.getSite();af.name=b.getCountername();af.ns_ti=document.title;af.ns_c=(document.characterSet?document.characterSet:document.defaultCharset);af.ns__t=(new Date().getTime());af.ns_jspageurl=location&&location.href?location.href:document.URL;af.ns_referrer=B();return af}function B(){return encodeURI(((window.orb.referrer)?window.orb.referrer:document.referrer))}function z(ai,ak,aj,ae){if(!I()){return}if(!f){if(!ae){A.push({labels:ai,callback:ak,event:aj})}return}if(c.length==0){throw Error("No data collectors available")}ai=n(ai);var ah=0;for(var ag=0;ag<c.length;ag++){collector=c[ag];seperator=collector.seperator||"&";var af=new Image();af.src=collector.url+"?"+V(ai,seperator);if(typeof ak==="function"){af.onload=function(){ah++;if(ah==c.length){ak()}}}}}W._sendData=z;function i(af){if(!af.intlink_from_url){return false}var ae=B();if(af.intlink_from_url.split("?")[0].split("#")[0]===ae.split("?")[0].split("#")[0]){return true}else{b.log("error","istats-internal-link-tracking",af);return false}}function Q(){if(f){return}var ag;if(!I()){return}ag=p()||a();f=true;var af=o({},q);if(ag){if(i(ag)){af=o(af,ag)}(r())._linkTracked=true}if(A.length>0){for(var ae in A){z(A[ae]["labels"],A[ae]["callback"],A[ae]["event"],true)}}b.log("pageview",b.getCountername(),af)}W.invoke=Q;function m(){if(typeof(istatsTrackingUrl)==="string"&&!D()){var ah=document.createElement("a");ah.href=istatsTrackingUrl;var ae="//"+ah.hostname+ah.pathname;b.addCollector({name:"default",url:ae,seperator:"&"});var af=ah.search.replace(/&amp;/g,"&").replace(/^\?/,"");var ag=ad(P(af));b.setCountername(ag.name);b.addLabels(ag);b.invoke()}}setTimeout(m,300);return W});