define(["jssignals-1","idcta/idCookie"],function(i,e){var c={signals:{signedIn:new i.Signal(),signinShown:new i.Signal()},ctas:{}};var k={width:608,height:614};function l(n){this.id=n.id;this.element=document.getElementById(n.id);this.states=n.states;var m=this;if(n.publiclyCacheable===true){if(e.getInstance().hasCookie()){a(m)}else{m.element.getElementsByTagName("span")[0].innerHTML=m.states.unauthorised.signedout}}n.ocContainer=m;this.signinHandler=j(this.element.querySelectorAll(".id4-cta-signin")[0],n);if(!n.policyname){this.registerHandler=h(this.element.querySelectorAll(".id4-cta-register")[0],n)}c.ctas[this.id]=this;c.signals.signedIn.add(function(){a(m)})}function a(m){if(m.states.authorised){var o=e.getInstance().getNameFromCookie();var n=m.states.authorised.anonymous;if(o){n=m.states.authorised.name.replace("{name}",o)}m.element.getElementsByTagName("span")[0].innerHTML=n}else{if(m.element.parentNode){m.element.parentNode.removeChild(m.element)}}}function h(n,m){if(b(m)){var o=function(p){if(!d(m,"register")){if(p.preventDefault){p.preventDefault()}else{p.returnValue=false}}};if(typeof(n)!=="undefined"&&typeof(n.jquery)!=="undefined"){n=n.get(0)}if(document.addEventListener&&typeof(n)!=="undefined"&&n.addEventListener){n.addEventListener("click",o,false)}else{if(document.attachEvent&&typeof(n)!=="undefined"&&n.attachEvent){n.attachEvent("onclick",o)}}return o}}function j(o,m){if(b(m)){var n=function(p){if(!d(m,"signin")){if(p.preventDefault){p.preventDefault()}else{return false}}};if(!m.ocContainer){m.ocContainer=o}if(typeof(o)!=="undefined"&&typeof(o.jquery)!=="undefined"){o=o.get(0)}if(document.addEventListener&&typeof(o)!=="undefined"&&o.addEventListener){o.addEventListener("click",n,false)}else{if(document.attachEvent&&typeof(o)!=="undefined"&&o.attachEvent){o.attachEvent("onclick",n)}}return n}}function g(m){if(typeof(m.id)!=="undefined"&&typeof(c.ctas[m.id])!=="undefined"&&typeof(c.ctas[m.id].signinHandler)!=="undefined"){if(document.removeEventListener){m.removeEventListener("click",c.ctas[m.id].signinHandler)}else{if(document.detachEvent){m.detachEvent("onclick",c.ctas[m.id].signinHandler)}}}}function b(m){return(m.useOverlay===true&&f())}function f(){return !(navigator.appVersion.indexOf("MSIE 6.")!=-1||navigator.appVersion.indexOf("MSIE 7.")!=-1||navigator.appVersion.indexOf("MSIE 8.")!=-1)}function d(n,m){if(window.innerWidth<=k.width||window.innerHeight<=k.height){return true}else{require(["idcta/overlayManager"],function(o){o.useOverlayController(n,m,c.signals)})}return false}c.Cta=l;c.unbindSigninClickTo=g;c.bindSigninClickTo=j;c.bindRegisterClickTo=h;c.hasCookie=function(){return e.getInstance().hasCookie()};c.getCookieInstance=function(){return e.getInstance()};c.getIdFromCookie=function(){return e.getInstance().getIdFromCookie()};c.getNameFromCookie=function(){return e.getInstance().getNameFromCookie()};return c});